#echo '/home/yunfeiguo/projects/PacBio_reference_genome/gap_closing/fill_hg38_by_hx1f4full/gfa_using_bwa/gfaBWA.pl -s -f 250 ~/database/hg_index/GCA_000001405.15_GRCh38_full_analysis_set.fna /home/yunfeiguo/projects/PacBio_reference_genome/falcon_aln/hx1_20150716/2-asm-falcon/hx1f4full.3rdfixedv2.fa > hg38_gaps_on_hx1f4full3rdfixedv2.250bpflank.bed' | qsub -V -cwd -m ea -M guoyunfei1989@gmail.com -l h_vmem=40G -N gfaBWA250bp2

##we can't use bedtools merge here because each of the filled gaps are independent from another
#/home/yunfeiguo/projects/PacBio_reference_genome/gap_closing/fill_hg38_by_hx1f4full/getUniqGapClosure.pl -l 1000 hg38_gaps_on_hx1f4full3rdfixedv2.250bpflank.bed > hg38_gaps_on_hx1f4full3rdfixedv2.250bpflank.1kboriginal.uniq.bed
#/home/yunfeiguo/projects/PacBio_reference_genome/gap_closing/fill_hg38_by_hx1f4full/getUniqGapClosure.pl hg38_gaps_on_hx1f4full3rdfixedv2.250bpflank.bed > hg38_gaps_on_hx1f4full3rdfixedv2.250bpflank.uniq.bed
#/home/yunfeiguo/projects/PacBio_reference_genome/gap_closing/fill_hg38_by_hx1f4full/getUniqGapClosure.pl -l 2000 hg38_gaps_on_hx1f4full3rdfixedv2.250bpflank.bed > hg38_gaps_on_hx1f4full3rdfixedv2.250bpflank.2kboriginal.uniq.bed
#/home/yunfeiguo/projects/PacBio_reference_genome/gap_closing/fill_hg38_by_hx1f4full/getUniqGapClosure.pl -l 10000 hg38_gaps_on_hx1f4full3rdfixedv2.250bpflank.bed > hg38_gaps_on_hx1f4full3rdfixedv2.250bpflank.10kboriginal.uniq.bed
#perl -ane 'print if $F[3]>30' hg38_gaps_on_hx1f4full3rdfixedv2.250bpflank.uniq.bed > hg38_gaps_on_hx1f4full3rdfixedv2.250bpflank.uniq.score30.bed
#perl -ane 'print if $F[3]>30' hg38_gaps_on_hx1f4full3rdfixedv2.250bpflank.uniq.bed > hg38_gaps_on_hx1f4full3rdfixedv2.250bpflank.1kboriginal.uniq.score30.bed
#perl -ane 'print if $F[3]>30' hg38_gaps_on_hx1f4full3rdfixedv2.250bpflank.2kboriginal.uniq.bed > hg38_gaps_on_hx1f4full3rdfixedv2.250bpflank.2kboriginal.uniq.score30.bed
#perl -ane 'print if $F[3]>30' hg38_gaps_on_hx1f4full3rdfixedv2.250bpflank.10kboriginal.uniq.bed > hg38_gaps_on_hx1f4full3rdfixedv2.250bpflank.10kboriginal.uniq.score30.bed
#cut -f 5 hg38_gaps_on_hx1f4full3rdfixedv2.250bpflank.1kboriginal.uniq.score30.bed > hg38_closed_gaps.1kboriginal.uniq.score30.txt
#grep -f hg38_closed_gaps.1kboriginal.uniq.score30.txt  hg38_gaps_on_hx1f4full3rdfixedv2.250bpflank.bed > hg38_gaps_on_hx1f4full3rdfixedv2_coordinate.1kboriginal.score30.bed
perl -e '@gapid = `cut -f 5 hg38_gaps_on_hx1f4full3rdfixedv2.250bpflank.1kboriginal.uniq.score30.bed`;chomp @gapid;@closedGap=`cut -f 1,2,3 hg38_gaps_on_hx1f4full3rdfixedv2.250bpflank.1kboriginal.uniq.score30.bed`;chomp @closedGap; %gap = map {($gapid[$_],$closedGap[$_])} 0..$#gapid; while(<>){@f=split;@g=($f[3]=~/(.*?)_(\d+)_(\d+)_(\w+\d+)/);print join("\t",@f[0,1,2],$gap{$g[3]},$g[3],@f[4,5,6])."\n" if exists $gap{$g[3]}}'  hg38_gaps_on_hx1f4full3rdfixedv2.250bpflank.1kboriginal.score30.bed > hg38_gaps_on_hx1f4full3rdfixedv2.250bpflank.1kboriginal.uniq.score30.withHX1Coordinates.bed
